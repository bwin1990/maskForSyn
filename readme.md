# 介绍
- 这是一个microarray 合成位点分割软件，将芯片表面的大点阵，分割成小点阵。
- 支持北京简辑的23k，680k 芯片，也允许订制其它点阵规格
- 支持将分割后的位点，输出为相应mask文件

# 使用python
- 使用python3.10 以上版本
- 依赖包：
  - PyQt6：GUI界面框架
  - NumPy：点阵数据处理
  - OpenGL：大规模点阵渲染（可选）

# 实现方案

## 点阵显示
1. 数据结构
   - 使用NumPy二维数组存储点阵数据
   - 每个点存储状态：未分配(0)、已分配(1)、选中(2)等

2. 渲染优化
   - 分块渲染：将大点阵分成多个小块(如 50x50)进行渲染
   - 视口裁剪：只渲染当前可见区域的点阵
   - 缓存机制：缓存已渲染的点阵块，避免重复计算
   - 考虑使用OpenGL进行硬件加速渲染（对于680k这样的大规模点阵）

3. 缩放实现
   - 多级缩放：预设几个缩放级别（如0.5x, 1x, 2x, 4x）
   - 动态调整点的显示大小和间距
   - 在高缩放比例下显示坐标网格和标注

## 分割框实现

1. 矩形分割框
   - 通过两点确定：起始点(row1, col1)和结束点(row2, col2)
   - 鼠标拖拽实现：
     1. 按下左键：记录起始点
     2. 拖动：实时更新矩形大小，显示半透明预览
     3. 释放：确定结束点，创建分割区域

2. 多边形分割框
   - 点集合实现：存储多边形的顶点序列
   - 交互方式：
     1. 点击添加顶点
     2. 移动显示预览线
     3. 双击或回到起点完成绘制
   - 填充算法：扫描线算法实现多边形填充

3. 区域管理
   - 命名规则：自动分配a-z的区域名
   - 颜色管理：为每个区域分配不同的半透明颜色
   - 重叠检测：使用点阵扫描或几何算法检测区域重叠

4. 编辑功能
   - 区域移动：鼠标拖拽整个区域
   - 顶点编辑：选中并拖动顶点
   - 删除功能：删除选中的区域
   - 属性编辑：修改区域名称、颜色等

## 输出格式
1. Mask文件格式
   - 每个区域生成独立的mask文件
   - 文件格式：
     ```
     区域名称: A
     类型: 矩形/多边形
     点阵范围: 
       - 起始行: 1
       - 结束行: 100
       - 起始列: 1
       - 结束列: 50
     顶点列表: [(x1,y1), (x2,y2), ...]
     ```

# 使用流程
1. 创建/加载点阵
   - 选择芯片类型(23k/680k)或自定义规格
   - 设置点阵参数(行数、列数)

2. 添加分割区域
   - 选择区域类型(矩形/多边形)
   - 使用鼠标在点阵上绘制
   - 或通过坐标输入创建

3. 编辑和调整
   - 移动/调整区域
   - 检查重叠
   - 预览效果

4. 导出结果
   - 生成mask文件
   - 保存项目配置

# 注意事项
- 大规模点阵(如680k)的性能优化
- 区域重叠的实时检测
- 撤销/重做功能的实现
- 项目文件的保存和恢复
